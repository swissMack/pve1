%% EMQX 5.x Access Control List Configuration
%% Format: {permission, who, action, topics}

%% Allow all for admin
{allow, {user, "admin"}, all, ["#"]}.

%% System topics
{deny, all, publish, ["$SYS/#"]}.
{allow, all, subscribe, ["$SYS/#"]}.

%% Device topics
{allow, all, all, ["$devices/${clientid}/#"]}.

%% Shared subscriptions
{allow, all, subscribe, ["$share/+/#"]}.

%% Client/user topics
{allow, all, all, ["devices/${clientid}/#"]}.
{allow, all, all, ["clients/${clientid}/#"]}.
{allow, all, all, ["users/${username}/#"]}.

%% Public topics
{allow, all, subscribe, ["public/#"]}.
{allow, all, subscribe, ["broadcast/#"]}.

%% Test topics
{allow, all, all, ["test/#"]}.
{allow, all, all, ["integration/#"]}.

%% Telemetry
{allow, all, publish, ["telemetry/#"]}.
{allow, all, subscribe, ["telemetry/#"]}.

%% Commands
{allow, all, subscribe, ["commands/${clientid}/#"]}.
{allow, {user, "admin"}, publish, ["commands/#"]}.

%% Additional test topics
{allow, all, all, ["filter/#"]}.
{allow, all, all, ["webhook/#"]}.
{allow, all, all, ["transform/#"]}.
{allow, all, all, ["alerts/#"]}.
{allow, all, all, ["input/#"]}.
{allow, all, all, ["output/#"]}.
{allow, all, all, ["extract/#"]}.
{allow, all, all, ["qos/#"]}.
{allow, all, all, ["fanout/#"]}.
{allow, all, all, ["source/#"]}.
{allow, all, all, ["aggregated/#"]}.
{allow, all, all, ["retain/#"]}.
{allow, all, all, ["enrich/#"]}.
{allow, all, all, ["enriched/#"]}.
{allow, all, all, ["events/#"]}.
{allow, all, all, ["sensors/#"]}.
