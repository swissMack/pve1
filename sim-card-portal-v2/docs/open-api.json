{"openapi":"3.1.0","info":{"title":"Analytics Service API","description":"REST API for usage rollups and unique IMSI counts.\n\nPeriod parameter syntax: pass a single 'period' query parameter where the format conveys granularity, and an optional 'periodEnd' with the same format for an inclusive range:\n- yyyy → year bucket (e.g., 2025)\n- yyyy-MM → month bucket (e.g., 2025-12)\n- yyyy-MM-dd → day bucket (e.g., 2025-12-28)\n- periodEnd: optional; must be >= period and use the same format; when present the service returns rows for each bucket between period and periodEnd inclusive (no aggregation across buckets).\n\nCSV parameters: 'imsi' and 'mccmnc' accept repeated query params (e.g. imsi=111&imsi=222) or comma-separated values (imsi=111,222).","version":"1.0.0"},"servers":[{"url":"http://localhost:9010","description":"Generated server url"}],"security":[{"auth":[]},{"auth":[]}],"tags":[{"name":"Analytics","description":"Analytics rollup queries. Use the 'period' parameter with formats yyyy, yyyy-MM, or yyyy-MM-dd to select year/month/day buckets. Optional 'periodEnd' may be supplied with the same format as 'period' to request an inclusive range of buckets."}],"paths":{"/ping":{"get":{"tags":["test-service"],"operationId":"ping","responses":{"400":{"description":"Bad request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string"}}}}}}},"/hello":{"get":{"tags":["test-service"],"operationId":"greet","responses":{"400":{"description":"Bad request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Server error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Unauthorized","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"string"}}}}},"403":{"description":"Forbidden","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"string"}}}}}}}},"/analytics/unique/imsi/count/tenant/network":{"get":{"tags":["Analytics"],"summary":"Unique IMSI count per tenant per network","description":"Returns the count of unique IMSIs per MCCMNC network for the requested period or an inclusive range when 'periodEnd' is provided.\n\nParameters:\n- tenant: scope identifier.\n- mccmnc: optional filter; may be repeated or CSV.\n- period: format conveys granularity: 'yyyy', 'yyyy-MM', or 'yyyy-MM-dd'.\n- periodEnd: optional end of range with the same format as 'period'; must not be earlier than 'period'. When present, results include all buckets from 'period' to 'periodEnd' inclusive (no cross-bucket aggregation).\n\nSorting: results are ordered by mccmnc, then by period fields (day → month → year).","operationId":"uniqueImsiTenantNetwork","parameters":[{"name":"tenant","in":"query","required":true,"schema":{"type":"string"}},{"name":"mccmnc","in":"query","required":false,"schema":{"type":"array","items":{"type":"string"}}},{"name":"period","in":"query","required":true,"schema":{"type":"string"}},{"name":"periodEnd","in":"query","required":false,"schema":{"type":"string"}}],"responses":{"400":{"description":"Invalid request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Server error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UniqueImsi"}}}}},"401":{"description":"Unauthorized","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UniqueImsi"}}}}},"403":{"description":"Forbidden","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UniqueImsi"}}}}}}}},"/analytics/unique/imsi/count/customer/network":{"get":{"tags":["Analytics"],"summary":"Unique IMSI count per customer per network","description":"Returns the count of unique IMSIs per MCCMNC network for the requested period or an inclusive range when 'periodEnd' is provided.\n\nParameters:\n- tenant, customer: scope identifiers.\n- mccmnc: optional filter; may be repeated or CSV.\n- period: format conveys granularity: 'yyyy', 'yyyy-MM', or 'yyyy-MM-dd'.\n- periodEnd: optional end of range with the same format as 'period'; must not be earlier than 'period'. When present, results include all buckets from 'period' to 'periodEnd' inclusive (no cross-bucket aggregation).\n\nSorting: results are ordered by mccmnc, then by period fields (day → month → year).","operationId":"uniqueImsiCustomerNetwork","parameters":[{"name":"tenant","in":"query","required":true,"schema":{"type":"string"}},{"name":"customer","in":"query","required":true,"schema":{"type":"string"}},{"name":"mccmnc","in":"query","required":false,"schema":{"type":"array","items":{"type":"string"}}},{"name":"period","in":"query","required":true,"schema":{"type":"string"}},{"name":"periodEnd","in":"query","required":false,"schema":{"type":"string"}}],"responses":{"400":{"description":"Invalid request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Server error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UniqueImsi"}}}}},"401":{"description":"Unauthorized","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UniqueImsi"}}}}},"403":{"description":"Forbidden","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UniqueImsi"}}}}}}}},"/analytics/tenant/network":{"get":{"tags":["Analytics"],"summary":"Usage per tenant per network","description":"Returns deduplicated byte usage per tenant and per MCCMNC network for the requested period or an inclusive range when 'periodEnd' is provided.\n\nParameters:\n- tenant: scope identifier.\n- mccmnc: optional filter; may be repeated or CSV.\n- period: format conveys granularity: 'yyyy', 'yyyy-MM', or 'yyyy-MM-dd'.\n- periodEnd: optional end of range with the same format as 'period'; must not be earlier than 'period'. When present, results include all buckets from 'period' to 'periodEnd' inclusive (no cross-bucket aggregation).\n\nSorting: results are ordered by mccmnc, then by period fields (day → month → year).","operationId":"tenantNetwork","parameters":[{"name":"tenant","in":"query","required":true,"schema":{"type":"string"}},{"name":"mccmnc","in":"query","required":false,"schema":{"type":"array","items":{"type":"string"}}},{"name":"period","in":"query","required":true,"schema":{"type":"string"}},{"name":"periodEnd","in":"query","required":false,"schema":{"type":"string"}}],"responses":{"400":{"description":"Invalid request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Server error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Usage"}}}}},"401":{"description":"Unauthorized","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Usage"}}}}},"403":{"description":"Forbidden","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Usage"}}}}}}}},"/analytics/imsi":{"get":{"tags":["Analytics"],"summary":"Usage per IMSI","description":"Returns deduplicated byte usage per IMSI for the requested period or an inclusive range when 'periodEnd' is provided.\n\nParameters:\n- tenant, customer: scope identifiers.\n- imsi: one or more IMSI values; may be repeated (imsi=111&imsi=222) or CSV (imsi=111,222).\n- period: a single string whose format conveys granularity: 'yyyy' (year), 'yyyy-MM' (month), or 'yyyy-MM-dd' (day).\n- periodEnd: optional end of range with the same format as 'period'; must not be earlier than 'period'. When present, results include all buckets from 'period' to 'periodEnd' inclusive (no cross-bucket aggregation).\n\nExamples: period=2025 (year), period=2025-12 (month), period=2025-12-28 (day).\n\nSorting: results are ordered by imsi, then by period fields (day → month → year).","operationId":"imsi","parameters":[{"name":"tenant","in":"query","required":true,"schema":{"type":"string"}},{"name":"customer","in":"query","required":true,"schema":{"type":"string"}},{"name":"imsi","in":"query","required":true,"schema":{"type":"array","items":{"type":"string"}}},{"name":"period","in":"query","required":true,"schema":{"type":"string"}},{"name":"periodEnd","in":"query","required":false,"schema":{"type":"string"}}],"responses":{"400":{"description":"Invalid request (e.g. bad period format)","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Server error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Usage"}}}}},"401":{"description":"Unauthorized","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Usage"}}}}},"403":{"description":"Forbidden","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Usage"}}}}}}}},"/analytics/imsi/network":{"get":{"tags":["Analytics"],"summary":"Usage per IMSI per network","description":"Returns deduplicated byte usage per IMSI and per MCCMNC network for the requested period or an inclusive range when 'periodEnd' is provided.\n\nParameters:\n- tenant, customer: scope identifiers.\n- imsi: one or more IMSI values; may be repeated (imsi=111&imsi=222) or CSV (imsi=111,222).\n- mccmnc: optional filter; may be repeated or CSV.\n- period: format conveys granularity: 'yyyy' (year), 'yyyy-MM' (month), or 'yyyy-MM-dd' (day).\n- periodEnd: optional end of range with the same format as 'period'; must not be earlier than 'period'. When present, results include all buckets from 'period' to 'periodEnd' inclusive (no cross-bucket aggregation).\n\nSorting: results are ordered by imsi, then by period fields (day → month → year), then by mccmnc.","operationId":"imsiNetwork","parameters":[{"name":"tenant","in":"query","required":true,"schema":{"type":"string"}},{"name":"customer","in":"query","required":true,"schema":{"type":"string"}},{"name":"imsi","in":"query","required":true,"schema":{"type":"array","items":{"type":"string"}}},{"name":"mccmnc","in":"query","required":false,"schema":{"type":"array","items":{"type":"string"}}},{"name":"period","in":"query","required":true,"schema":{"type":"string"}},{"name":"periodEnd","in":"query","required":false,"schema":{"type":"string"}}],"responses":{"400":{"description":"Invalid request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Server error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Usage"}}}}},"401":{"description":"Unauthorized","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Usage"}}}}},"403":{"description":"Forbidden","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Usage"}}}}}}}},"/analytics/customer/network":{"get":{"tags":["Analytics"],"summary":"Usage per customer per network","description":"Returns deduplicated byte usage per customer and per MCCMNC network for the requested period or an inclusive range when 'periodEnd' is provided.\n\nParameters:\n- tenant, customer: scope identifiers.\n- mccmnc: optional filter; may be repeated or CSV.\n- period: format conveys granularity: 'yyyy', 'yyyy-MM', or 'yyyy-MM-dd'.\n- periodEnd: optional end of range with the same format as 'period'; must not be earlier than 'period'. When present, results include all buckets from 'period' to 'periodEnd' inclusive (no cross-bucket aggregation).\n\nSorting: results are ordered by mccmnc, then by period fields (day → month → year).","operationId":"customerNetwork","parameters":[{"name":"tenant","in":"query","required":true,"schema":{"type":"string"}},{"name":"customer","in":"query","required":true,"schema":{"type":"string"}},{"name":"mccmnc","in":"query","required":false,"schema":{"type":"array","items":{"type":"string"}}},{"name":"period","in":"query","required":true,"schema":{"type":"string"}},{"name":"periodEnd","in":"query","required":false,"schema":{"type":"string"}}],"responses":{"400":{"description":"Invalid request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Server error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Usage"}}}}},"401":{"description":"Unauthorized","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Usage"}}}}},"403":{"description":"Forbidden","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Usage"}}}}}}}}},"components":{"schemas":{"ErrorResponse":{"type":"object","description":"Standard error payload returned by this service","properties":{"status":{"type":"integer","format":"int32","description":"HTTP status code","example":400},"error":{"type":"string","description":"Error name","example":"Bad Request"},"message":{"type":"string","description":"Human readable reason","example":"Invalid 'period' format. Use yyyy, yyyy-MM or yyyy-MM-dd"},"path":{"type":"string","description":"Request path","example":"/analytics/imsi"},"timestamp":{"type":"string","format":"date-time","description":"Time when the error was produced in UTC","example":"2025-12-29T01:02:00Z"}}},"UniqueImsi":{"type":"object","properties":{"year":{"type":"string","format":"date","description":"Year bucket in yyyy","example":2025},"month":{"type":"string","format":"date","description":"Month bucket in yyyy-MM","example":"2025-12"},"day":{"type":"string","format":"date","description":"Day bucket in yyyy-MM-dd","example":"2025-12-28"},"mccmnc":{"type":"string","description":"Mobile Network Code (MCCMNC)","example":22288},"uniqueImsiCount":{"type":"integer","format":"int64","description":"Count of unique IMSIs for the bucket","example":421},"latestEventAt":{"type":"string","format":"date-time","description":"Timestamp of the latest contributing event (UTC)","example":"2025-12-28T16:00:00Z"}}},"Usage":{"type":"object","properties":{"year":{"type":"string","format":"date","description":"Year bucket in yyyy","example":2025},"month":{"type":"string","format":"date","description":"Month bucket in yyyy-MM","example":"2025-12"},"day":{"type":"string","format":"date","description":"Day bucket in yyyy-MM-dd","example":"2025-12-28"},"mccmnc":{"type":"string","description":"Mobile Network Code (MCCMNC)","example":22288},"imsi":{"type":"string","description":"International Mobile Subscriber Identity","example":234507093108712},"bytes":{"type":"integer","format":"int64","description":"Total bytes (deduplicated) for the bucket","example":123456789},"latestEventAt":{"type":"string","format":"date-time","description":"Timestamp of the latest contributing event (UTC)","example":"2025-12-28T16:00:00Z"}}}},"securitySchemes":{"auth":{"type":"oauth2","flows":{"password":{"authorizationUrl":"http://keycloak:8080/realms/Demo-Realm/openid-connect/auth","tokenUrl":"http://keycloak:8080/realms/Demo-Realm/protocol/openid-connect/token","refreshUrl":"http://keycloak:8080/realms/Demo-Realm/protocol/openid-connect/token","scopes":{}}}}}}}